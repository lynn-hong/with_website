{% extends "website/base.html" %}
{% load staticfiles %}


{% block page_content %}
    <script>
        // 인원 추가 submit
        addAttendeeSubmit = function(){
            var data = $('#add_attendee_form').serializeArray();
            $.ajax({
                type: "POST",
                url: {% url 'add_attendee' %},
                data: data,
                beforeSend: function(){
                    $('#update_people').html("<img src={% static 'preloader/loader_icon.gif' %} /> 참석자 추가가 진행중입니다!");
                },
                success: function(response){ location.replace( window.location.href )},
            });
        }

        // 최종 출석체크 submit
        attendanceCheckSubmit = function(){
            var data = $('#final_form').serializeArray();
            $.ajax({
                type: "POST",
                url: {% url 'submit_attendance' %},
                data: data,
                beforeSend: function(){
                    $('#final_submit_btn').html("<img src={% static 'preloader/loader_icon.gif' %} /> 출석체크 저장이 진행중입니다!");
                },
                success: function(response){ location.reload(); },
            });
        }
    </script>


    <section class="p-t-50 p-b-120">
        <div class="container" style="padding: 0 !important;">
            <div class="row">
                <div class="col-lg-12 center">
                <h1 class="font-weight-800" style="text-align: center;">
                    <script type="text/javascript">
                        var date=new Date(),
                          year = date.getFullYear(),
                          text = year + " 운영진 연락처",
                          html = text;
                        document.write(html);
                    </script>

                </h1>
                    <div class="col-lg-6 center">
                        <h4 style="text-align: center;">*
                            <span class="highlight highlight-colored">
                                연락처는 중요 개인정보이니 유출하지 말아 주시길 부탁드립니다.
                            </span>
                        </h4>

                        <form name="final_form" id="final_form">
                        {% csrf_token %}
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">직함</th>
                                    <th scope="col">이름</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for staff in staffs %}
                                <tr>
                                    <th scope="row">{{ forloop.counter }}</th>
                                    <td>
                                        {{ staff.get_staff_category_display }}
                                    </td>
                                    <td>
                                        {% if staff.m.cellphone %}
                                            <a href="tel:{{ staff.m.cellphone }}">
                                                {{ staff.m.name }} {{ staff.m.baptismal_name }}{{ staff.is_guest }}
                                                <i class="fas fa-phone"></i>
                                            </a>
                                        {% else %}
                                            {{ staff.m.name }} {{ staff.m.baptismal_name }}{{ staff.is_guest }}
                                        {% endif %}
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>

                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

<script>
    document.getElementById('header').setAttribute("data-transparent", "false");
</script>

{% endblock %}
